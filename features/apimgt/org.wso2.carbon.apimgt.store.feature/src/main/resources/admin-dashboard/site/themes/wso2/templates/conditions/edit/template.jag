<% jagg.template("conditions/edit", function(inputs, outputs, jagg) { %>
<div id='tier-add-container' class="row-fluid"  style="display:inline">

	<div class="page-header">
                <div class="page-title">
                    <h1><%=i18n.localize("selectBlockingEntity")%></h1>
                 </div>
         </div>


    <div class="content-section shadow-up">
        <div class="content-data">
            <input type='hidden' id='errorMsgRequired' name='errorMsgRequired'
                value='<%=i18n.localize("errorMsgRequired")%>'/>
                <input type='hidden' id='errorMessageInvalid' name='errorMessageInvalid'
                value='<%=i18n.localize("errorMessageInvalid")%>'/>
                <input type='hidden' id='errorMessageIllegalChar' name='errorMessageIllegalChar'
                value='<%=i18n.localize("errorMessageIllegalChar")%>'/>
            <div class="row-fluid">
                <form class="apim-form form-horizontal" method="POST" id="tier_form" enctype="multipart/form-data"
                    action="/admin-dashboard/site/blocks/conditions/edit/ajax/conditions-edit.jag">
                        <div class="form-group" id="selected-type">
                            <label class="col-sm-3 control-label">
                                <span class="requiredAstrix">*</span>Select Condition Type</label>
                           <div class="col-sm-9">
                            <label class="radio">
                                <input type="radio" name="select-option" value="API" checked>
                                <span class="helper">API</span>
                            </label>
                            <label class="radio">
                                <input type="radio" name="select-option" value="APPLICATION">
                                <span class="helper">APPLICATION</span>
                            </label>
                            <label class="radio">
                                <input type="radio" name="select-option" value="IP">
                                <span class="helper">IP Address</span>
                            </label>
                                <label class="radio">
                                <input type="radio" name="select-option" value="USER">
                                <span class="helper">USER</span>
                            </label>
                        </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">Value :
                            <span class="requiredAstrix">*</span></label>
                            <div class="col-sm-3">
                                <input type='hidden' id='errorMsgRequired' name='errorMsgRequired'
                value='<%=i18n.localize("errorMsgRequired")%>'/>
                                <input class="form-control  required validInput noSpace" type="text" id="value"/>
                            </div>
                        </div>
                        </div>
                                      	<br class="spacer">
                    <div class="form-actions">
                        <input id="add-condition-btn" onclick="addCondition()" name="save-tier-btn" type="button"
                            class="btn btn-primary" value='<%=i18n.localize("block")%>'/>
                        <input id="cancel-condition-btn" type="reset" class="btn"  value='<%=i18n.localize("cancelTier")%>'>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function addCondition(){
        var conditionType = $('input[name=select-option]:checked').val();
        var conditionValue = $('#value');
        var requiredMsg = $('#errorMsgRequired').val();
        var conditionValueTxt = conditionValue.val();
        var requiredMsg = $('#errorMsgRequired').val();
       if(!validateInput(conditionValueTxt,conditionValue,requiredMsg)){
            return false;
        }

 jagg.post("/site/blocks/conditions/edit/ajax/condition-edit.jag", {
        action:"addCondition",
        conditionType:conditionType,
        conditionValue:conditionValueTxt
        }, function (result) {
            if (result.error == false) {
         location.href = "<%= jagg.url('/site/pages/conditions-manage.jag')%>";
            } else {
                jagg.message({content:result.message,type:"error"});
            }
        },
    "json");
    }
    function validateInput(text, element, errorMsg){
    var elementId = element.attr('id');
    text = text.trim();
    if(text == ""){
        element.css("border", "1px solid red");
        $('#label'+elementId).remove();
        element.parent().append('<label class="error" id="label'+elementId+'" >' + errorMsg + '</label>');
        return false;
    }else{
        $('#label'+elementId).remove();
        element.css("border", "1px solid #cccccc");
        return true;
    }
}
        $(document).ready(function(){
        $('#cancel-condition-btn').on('click',function(){
            location.href = "<%= jagg.url('/site/pages/conditions-manage.jag')%>";
                });
        });
</script>

<%});%>
